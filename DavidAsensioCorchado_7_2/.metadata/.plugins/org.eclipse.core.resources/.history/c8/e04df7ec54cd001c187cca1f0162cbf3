package Ejercicio1;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;

import java.sql.PreparedStatement;

public class empresa {
	ArrayList<Empleado> listaEmpleado = new ArrayList<>();

	public ArrayList<Empleado> getListaEmpleado(ArrayList<Empleado> listaEmpleados) {
		return listaEmpleados;
	}

	private Connection conexion;

	public void conectarBD() {

		try {
			// Conectamos con la base de datos
			conexion = DriverManager.getConnection("jdbc:mysql://localhost:3306/empleados", "root", "");
			System.out.println((conexion != null) ? "CONEXION OK" : "CONEXION FALLIDA");

		} catch (java.sql.SQLException sqle) {
			System.out.println("Error: " + sqle);
		}
	}

	public ResultSet consultar(String dniInsertado) {
		ResultSet resultado;
		try {
			PreparedStatement sentencia = conexion
					.prepareStatement("SELECT * from empleados where dni = '" + dniInsertado + "'");
			resultado = sentencia.executeQuery();
		} catch (SQLException e) {
			e.printStackTrace();
			return null;
		}
		return resultado;
	}

	public boolean insertarDatos1(String name, String surname1, String surname2, Double salary) {
		System.out.println("Procedemos a insertar datos.");
		try {
			PreparedStatement sentenciaInsertar = conexion.prepareStatement(
					"INSERT INTO EMPLEADOS (dni,nombre,apellido1,apellido2,sueldo)" + "values (?,?,?,?))");
			sentenciaInsertar.setString(1, name);
			sentenciaInsertar.setString(2, surname1);
			sentenciaInsertar.setString(3, surname2);
			sentenciaInsertar.setDouble(4, salary);

			ResultSet rs = sentenciaInsertar.executeQuery();
			while (rs.next()) {
				System.out.println(
						rs.getString(1) + " " + rs.getString(2) + " " + rs.getString(3) + " " + rs.getDouble(4));
				return true;
			}
			rs.close();

		} catch (Exception e) {
			System.out.println("Parece que hay un error, no conecta !!!");

		}
		return false;

	}

	/*
	 * "insert into empleados values('" + empleado.getDni() + "', '" +
	 * empleado.getNombre() + "', '" + empleado.getApellido() + "', " +
	 * empleado.getSueldo() + ", "+empleado.getId();
	 */

	public boolean ejecutar(String cambio) {
		try {
			PreparedStatement sentencia = conexion.prepareStatement(cambio);
			int totalRows = sentencia.executeUpdate(); // devuelve el n√∫mero de tuplas modificadas
			System.out.println("Se han modificado: " + totalRows + " tuplas");
			sentencia.close();
		} catch (SQLException e) {
			e.printStackTrace();
			return false;
		}
		return true;
	}

	public void imprimirResultado(ResultSet resultado) {
		try {
			System.out.println("\nDNI\tNOMBRE\tAPELLIDO\tSUELDO\tID");
			System.out.println("--------------------------------");
			while (resultado.next()) {
				System.out.println(resultado.getString("dni") + "\t" + resultado.getString("nombre") + "\t"
						+ resultado.getString("apellidos") + "\t" + +resultado.getInt("sueldo") + "\t"
						+ resultado.getInt("id"));
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

}